<?xml version="1.0" encoding="UTF-8"?>
<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://modeler.netgrif.com/petriflow_schema.xsd">
	<id>Praca</id>
	<initials>PRC</initials>
	<title>Práca</title>
	<defaultRole>false</defaultRole>
	<transitionRole>false</transitionRole>
	<!-- TRANSACTIONS -->
	<!-- ROLES -->
	<!-- DATA -->
	<data type="text">
		<id>meno_veduceho</id>
		<title>Meno vedúceho</title>
		<placeholder>Meno vedúceho diplomovej práce</placeholder>
		<desc>Zadajte meno vedúceho diplomovej práce</desc>
	</data>
	<data type="text">
		<id>priezvisko_veduceho</id>
		<title>Priezvisko vedúceho</title>
		<placeholder>Priezvisko vedúceho diplomovej práce</placeholder>
		<desc>Zadajte priezvisko vedúceho diplomovej práce</desc>
	</data>
	<data type="text">
		<id>email_veduceho</id>
		<title>Email vedúceho</title>
		<placeholder>Email vedúceho diplomovej práce</placeholder>
		<desc>Zadajte email vedúceho diplomovej práce</desc>
	</data>
	<data type="text">
		<id>nazov_temy</id>
		<title>Názov témy diplomovej práce</title>
		<placeholder>Názov témy diplomovej práce</placeholder>
		<desc>Zadajte názov témy diplomovej práce</desc>
	</data>
	<data type="text">
		<id>zadanie</id>
		<title>Zadanie</title>
		<placeholder>Zadanie diplomovej práce</placeholder>
		<desc>Zadajte text zadania diplomovej práce</desc>
		<values>area</values>
	</data>
	<data type="taskRef">
		<id>student</id>
		<title>Študent</title>
		<placeholder>Task ref na úlohu Študent</placeholder>
		<desc>Task ref na úlohu Študent</desc>
	</data>
	<data type="text">
		<id>meno_studenta</id>
		<title>Meno študenta</title>
	</data>
	<data type="text">
		<id>priezvisko_studenta</id>
		<title>Priezvisko študenta</title>
	</data>
	<data type="file">
		<id>praca</id>
		<title>Diplomová práca v PDF</title>
		<placeholder>Súbor obsahujúci diplomovú prácu</placeholder>
		<desc>Vložte PDF súbor s diplomovou prácou</desc>
	</data>
	<data type="enumeration">
		<id>znamka</id>
		<title>Známka</title>
		<placeholder>Výsledná známka</placeholder>
		<desc>Zvoľ výslednú známku</desc>
		<values>A</values>
		<values>B</values>
		<values>C</values>
		<values>D</values>
		<values>E</values>
		<values>FX</values>
		<values>FN</values>
		<init>A</init>
	</data>
	<data type="taskRef">
		<id>tema</id>
		<title></title>
		<init>t2</init>
	</data>
	<data type="userList">
		<id>autor</id>
		<title/>
	</data>
	<!-- TRANSITIONS -->
	<transition>
		<id>t1</id>
		<x>300</x>
		<y>60</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Téma</label>
		<dataGroup>
			<id>DataGroup_0</id>
			<layout>grid</layout>
			<dataRef>
				<id>meno_veduceho</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>priezvisko_veduceho</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>0</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>email_veduceho</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>nazov_temy</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>zadanie</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>3</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>
	<transition>
		<id>t2</id>
		<x>100</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Init</label>
		<trigger type="auto"/>
		<event type="finish">
			<id>t2_finish</id>
			<actions phase="pre">
				<action>
				meno: f.meno_veduceho,
				priezvisko: f.priezvisko_veduceho,
				email: f.email_veduceho,
				tema: f.tema,
				autor: f.autor;
				change meno value {userService.loggedOrSystem.name}
				change priezvisko value {userService.loggedOrSystem.surname}
				change email value {userService.loggedOrSystem.email}
				change tema value {[useCase.tasks.find{it.transition=="t1"}?.task]
					}
				change autor value {
						[userService.getLoggedOrSystem().id]
					}
                </action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>t3</id>
		<x>300</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zadanie témy diplomovej práce</label>
		<usersRef>
			<id>autor</id>
			<logic>
				<perform>true</perform>
			</logic>
		</usersRef>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>tema</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>
	<transition>
		<id>t4</id>
		<x>540</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Rezervácia diplomovej práce</label>
	</transition>
	<transition>
		<id>t5</id>
		<x>780</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Potvrdenie rezervácie</label>
		<usersRef>
			<id>autor</id>
			<logic>
				<perform>true</perform>
			</logic>
		</usersRef>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>student</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>t5_finish</id>
			<actions phase="pre">
				<action>
				student: f.student;
				def stud_uloha = findTask({it._id.eq(student.value[0])})
				def pripad = findCase({it._id.eq(stud_uloha.caseId)})
				def uloha = findTask ({it.caseId.eq(pripad.stringId).and(it.transitionId.eq("t4"))})
				
						async.run {
						assignTask(uloha)
						finishTask(uloha)
						}
			</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>t6</id>
		<x>540</x>
		<y>60</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zamietnutie rezervácie</label>
		<usersRef>
			<id>autor</id>
			<logic>
				<perform>true</perform>
			</logic>
		</usersRef>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>student</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>t6_finish</id>
			<actions phase="pre">
				<action>
				student: f.student;
				def stud_uloha = findTask({it._id.eq(student.value[0])})
				def pripad = findCase({it._id.eq(stud_uloha.caseId)})
				def uloha = findTask ({it.caseId.eq(pripad.stringId).and(it.transitionId.eq("t5"))})
				
						async.run {
						assignTask(uloha)
						finishTask(uloha)
						}
			</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>t7</id>
		<x>1020</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Podanie diplomovej práce</label>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>tema</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>student</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>praca</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>t7_finish</id>
			<actions phase="pre">
				<action>
				student: f.student,
				meno: f.meno_studenta,
				priezvisko: f.priezvisko_studenta;
				def uloha = findTask({it._id.eq(student.value[0])})
				def pripad = findCase({it._id.eq(uloha.caseId)})
				change meno value { pripad.getFieldValue("std_meno")}
				change priezvisko value { pripad.getFieldValue("std_priezvisko")}
			</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>t8</id>
		<x>1260</x>
		<y>140</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Obhajoba diplomovej práce</label>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>tema</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>student</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>znamka</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>t8_finish</id>
			<actions phase="post">
				<action>
					student: f.student,
					znamka: f.znamka;
					def uloha = findTask({it._id.eq(student.value[0])})
					def pripad = findCase({it._id.eq(uloha.caseId)})
					setData("t7", pripad, ["std_znamka": ["value": znamka.value.toString(), "type": "text"]])
				</action>
			</actions>
		</event>
	</transition>
	<!-- PLACES -->
	<place>
		<id>p1</id>
		<x>20</x>
		<y>140</y>
		<label></label>
		<tokens>1</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p2</id>
		<x>180</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p3</id>
		<x>420</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p4</id>
		<x>660</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p5</id>
		<x>900</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p6</id>
		<x>1140</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>p7</id>
		<x>1380</x>
		<y>140</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<!-- ARCS -->
	<arc>
		<id>a1</id>
		<type>regular</type>
		<sourceId>p1</sourceId>
		<destinationId>t2</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a2</id>
		<type>regular</type>
		<sourceId>t2</sourceId>
		<destinationId>p2</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a3</id>
		<type>regular</type>
		<sourceId>p2</sourceId>
		<destinationId>t3</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a4</id>
		<type>regular</type>
		<sourceId>t3</sourceId>
		<destinationId>p3</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a5</id>
		<type>regular</type>
		<sourceId>p3</sourceId>
		<destinationId>t4</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a6</id>
		<type>regular</type>
		<sourceId>t4</sourceId>
		<destinationId>p4</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a7</id>
		<type>regular</type>
		<sourceId>p4</sourceId>
		<destinationId>t6</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a8</id>
		<type>regular</type>
		<sourceId>t6</sourceId>
		<destinationId>p3</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a9</id>
		<type>regular</type>
		<sourceId>p4</sourceId>
		<destinationId>t5</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a10</id>
		<type>regular</type>
		<sourceId>t5</sourceId>
		<destinationId>p5</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a11</id>
		<type>regular</type>
		<sourceId>p5</sourceId>
		<destinationId>t7</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a12</id>
		<type>regular</type>
		<sourceId>t7</sourceId>
		<destinationId>p6</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a13</id>
		<type>regular</type>
		<sourceId>p6</sourceId>
		<destinationId>t8</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a14</id>
		<type>regular</type>
		<sourceId>t8</sourceId>
		<destinationId>p7</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
</document>
